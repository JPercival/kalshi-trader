<%- include('header') %>
<h1>Markets</h1>
<div class="card" style="margin-bottom: 1.5rem; display: flex; gap: 1rem; align-items: center; flex-wrap: wrap;">
  <span style="color: #8b8fa3;">Category:</span>
  <a href="/markets<%= filters.coinFlip ? '' : '?coinFlip=off' %>" style="color: <%= !filters.category ? '#4f9cf7' : '#8b8fa3' %>;">All</a>
  <% categories.forEach(cat => { %>
    <a href="/markets?category=<%= cat %><%= filters.coinFlip ? '' : '&coinFlip=off' %>" style="color: <%= filters.category === cat ? '#4f9cf7' : '#8b8fa3' %>;"><%= cat %></a>
  <% }); %>
  <span style="color: #333; margin-left: 0.5rem;">|</span>
  <span style="color: #8b8fa3;">Price:</span>
  <a href="/markets<%= filters.category ? '?category=' + filters.category : '' %>" style="color: <%= filters.coinFlip ? '#4f9cf7' : '#8b8fa3' %>;">ðŸŽ² Coin Flip (<%= (config.coinFlipMin * 100).toFixed(0) %>â€“<%= (config.coinFlipMax * 100).toFixed(0) %>Â¢)</a>
  <a href="/markets?coinFlip=off<%= filters.category ? '&category=' + filters.category : '' %>" style="color: <%= !filters.coinFlip ? '#4f9cf7' : '#8b8fa3' %>;">All Prices</a>
</div>
<div class="card">
  <table>
    <tr><th>Ticker</th><th>Title</th><th>Category</th><th>Status</th><th>Price</th><th>Result</th></tr>
    <% markets.forEach(m => { %>
    <tr>
      <td><a href="https://kalshi.com/markets/<%= m.event_ticker || m.ticker %>" target="_blank" rel="noopener" style="color: #4f9cf7;"><%= m.ticker %></a></td>
      <td><%= m.title || 'â€”' %></td>
      <td><%= m.category || 'â€”' %></td>
      <td><%= m.status %></td>
      <td><%= m.last_yes_price != null ? (m.last_yes_price * 100).toFixed(0) + 'Â¢' : 'â€”' %></td>
      <td><%= m.result || 'â€”' %></td>
    </tr>
    <% }); %>
  </table>
  <% if (markets.length === 0) { %>
    <p style="color: #8b8fa3; padding: 1rem 0;">No markets found. Run ingestion first.</p>
  <% } %>
</div>
<%- include('footer') %>
